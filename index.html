<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Sarkari Naukri Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; }
        .header { background: linear-gradient(to right, #004d40, #00695c); color: white; padding: 30px 0; margin-bottom: 20px; }
        
        /* Main State Tabs */
        .nav-pills .nav-link { color: #555; background: white; border: 1px solid #ddd; margin: 0 10px; border-radius: 50px; padding: 10px 30px; font-weight: bold; }
        .nav-pills .nav-link.active { background-color: #009688; color: white; border-color: #009688; }
        
        /* DISTRICT GRID LAYOUT (New Change) */
        .district-container { 
            display: flex;
            flex-wrap: wrap; /* This makes them go to the next line */
            justify-content: center;
            gap: 8px; /* Space between buttons */
            padding: 15px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .btn-district { 
            border-radius: 20px; 
            font-size: 0.85rem; 
            padding: 5px 15px;
        }
        .btn-district.active { background-color: #00796b; color: white; border-color: #00796b; }

        /* Job Card */
        .job-card { border: none; border-top: 5px solid #009688; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.2s; background: white; }
        .job-card:hover { transform: translateY(-5px); }
        .card-wb { border-top-color: #ffca28; } /* Yellow for West Bengal */
        
        .date-box { background: #e0f2f1; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; color: #00695c; font-weight: bold; }
    </style>
</head>
<body>

    <div class="header text-center">
        <h2>üáÆüá≥ Job Tracker</h2>
        <p>West Bengal & All India Notifications</p>
        <span class="badge bg-warning text-dark" id="last-updated">Updating...</span>
    </div>

    <div class="container">
        
        <ul class="nav nav-pills justify-content-center mb-4" id="state-tabs">
            <li class="nav-item"><a class="nav-link active" href="#" onclick="filterState('All India')">All India</a></li>
            <li class="nav-item"><a class="nav-link" href="#" onclick="filterState('West Bengal')">West Bengal</a></li>
        </ul>

        <div id="district-filter" class="mb-4" style="display:none;">
            <p class="text-center text-muted small mb-2">Select your District:</p>
            <div class="district-container">
                <button class="btn btn-outline-secondary btn-sm btn-district active" onclick="filterDistrict('All WB')">All WB</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Nadia')">Nadia</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Kolkata')">Kolkata</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('North 24 Parganas')">North 24 Pgs</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('South 24 Parganas')">South 24 Pgs</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Howrah')">Howrah</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Hooghly')">Hooghly</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Murshidabad')">Murshidabad</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Bankura')">Bankura</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Birbhum')">Birbhum</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Purba Bardhaman')">Purba Bardhaman</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Paschim Bardhaman')">Paschim Bardhaman</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Purba Medinipur')">Purba Medinipur</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Paschim Medinipur')">Paschim Medinipur</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Malda')">Malda</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Jalpaiguri')">Jalpaiguri</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Darjeeling')">Darjeeling</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Uttar Dinajpur')">Uttar Dinajpur</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Dakshin Dinajpur')">Dakshin Dinajpur</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Cooch Behar')">Cooch Behar</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Alipurduar')">Alipurduar</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Jhargram')">Jhargram</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Purulia')">Purulia</button>
                <button class="btn btn-outline-secondary btn-sm btn-district" onclick="filterDistrict('Kalimpong')">Kalimpong</button>
            </div>
        </div>

        <div id="job-container" class="row g-4">
            <div class="col-12 text-center"><div class="spinner-border text-success"></div></div>
        </div>
    </div>

    <script>
        let allJobs = [];
        let currentState = 'All India';
        let currentDistrict = 'All WB';

        fetch('jobs.json')
            .then(response => response.json())
            .then(data => {
                allJobs = [...data.active, ...data.upcoming];
                document.getElementById('last-updated').innerText = "Last Updated: " + data.last_updated;
                renderJobs();
            });

        function filterState(state) {
            currentState = state;
            document.querySelectorAll('#state-tabs .nav-link').forEach(el => el.classList.remove('active'));
            event.target.classList.add('active');
            
            const distDiv = document.getElementById('district-filter');
            if (state === 'West Bengal') {
                distDiv.style.display = 'block';
                currentDistrict = 'All WB';
            } else {
                distDiv.style.display = 'none';
            }
            renderJobs();
        }

        function filterDistrict(district) {
            currentDistrict = district;
            document.querySelectorAll('.btn-district').forEach(el => el.classList.remove('active', 'btn-secondary'));
            event.target.classList.add('active', 'btn-secondary');
            renderJobs();
        }

        function renderJobs() {
            const container = document.getElementById('job-container');
            container.innerHTML = '';

            const filtered = allJobs.filter(job => {
                if (currentState === 'All India') return true; 
                if (job.state !== currentState) return false;
                if (currentState === 'West Bengal' && currentDistrict !== 'All WB') {
                    return job.district === currentDistrict;
                }
                return true;
            });

            if (filtered.length === 0) {
                container.innerHTML = '<div class="col-12 text-center"><div class="alert alert-light border">No jobs found for this location today.</div></div>';
                return;
            }

            filtered.forEach(job => {
                const cardClass = job.state === 'West Bengal' ? 'card-wb' : '';
                const locationBadge = job.district && job.district !== 'All' ? `üìç ${job.district}` : 'üáÆüá≥ All India';
                
                let displayDate = new Date(job.date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short' });
                if (displayDate === 'Invalid Date') displayDate = "New";

                const html = `
                    <div class="col-md-6 col-lg-4">
                        <div class="card job-card h-100 ${cardClass}">
                            <div class="card-body">
                                <div class="d-flex justify-content-between mb-2">
                                    <span class="badge bg-light text-dark border">${locationBadge}</span>
                                    <span class="date-box">${displayDate}</span>
                                </div>
                                <h5 class="card-title fw-bold mb-3">${job.title}</h5>
                                <div class="d-grid gap-2">
                                    <a href="${job.link}" target="_blank" class="btn btn-outline-success btn-sm">
                                        View Notification ‚Üó
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }
    </script>
</body>
</html>
